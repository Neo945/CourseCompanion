{% extends 'base.html' %}

{% block title %}
Course
{% endblock title %}

{% block content %}
<div id="root">
</div>

<script>
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    
    function createVideo(list) {
        var str = `<video width='320' height='240' controls><source src="${list.video}" type='video/mp4'>Your browser does not support the video tag.</video>`
        return str
    }

    function val (){
        const xhr = new XMLHttpRequest()
        xhr.responseType = 'json'
        const id = document.getElementById("id")
        xhr.open('GET',`http://127.0.0.1:8000/api/video/8`)
        xhr.setRequestHeader('Content-Type','application/json')
        xhr.setRequestHeader("HTTP_X_REQUESTED_WITH","XMLHttpRequest")
        xhr.setRequestHeader("X-Requested-With","XMLHttpRequest")
        xhr.setRequestHeader('X-CSRFToken',getCookie('csrftoken'))
        xhr.onload = () =>{
            console.log(xhr.response,xhr.status)
            k = createVideo(xhr.response)
            const root = document.getElementById("root")
            root.innerHTML = k
        }
        xhr.send()
    }
    val()
    
</script>
{% endblock content %}